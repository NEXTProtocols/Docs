---
title: "Training"
description: "AI Price training time and price"
sidebarTitle: "Training"
icon: "brain-circuit"
tag: "NEW"
---



# Introduction

This benchmark tests the training time and price of different GPUs and models.

# Training with KohyaSS.

All the configuration was use in `H100 SXM GPU` with 10 pictures of `sfya`.

For make a training, you need to use the `KohyaSS` with or without the GUI.

The config file is the same for both `json` and `toml`. But if you want to launch a training with the GUI KohyaSS, you need to use the `json` file and 
  
if you want to launch a training with the CLI, you need to use the `toml` file with the following command :

<CodeGroup>
```bash single_gpu lines
/app/kohya_ss/.venv/bin/accelerate launch --dynamo_backend no --dynamo_mode default \
    --gpu_ids 0  \
    --mixed_precision bf16  \
    --num_processes 1 \
    --num_machines 1 \
    --num_cpu_threads_per_process 2 \
    /app/kohya_ss/sd-scripts/flux_train_network.py \
    --config_file \
    /app/output/model/config.toml
  ```

```bash multi_gpu lines highlight={2,4,5}
/app/kohya_ss/.venv/bin/accelerate launch --dynamo_backend no --dynamo_mode default \
    --gpu_ids 0,1 \ # <- 2 GPUs used for the training
    --mixed_precision bf16 \
    --multi_gpu \ # <- Multi GPU training
    --num_processes 2 \ # <- 2 GPUs workers = num_processes used for the training
    --num_machines 1 \
    --num_cpu_threads_per_process 2 \
    /app/kohya_ss/sd-scripts/flux_train_network.py \
    --config_file \
    /app/output/model/config.toml
  ```
</CodeGroup>

## Config file.

A important value change when you change the `GPU number` or/and `train batch size` is the **`learning_rate`**. We have 4 values for the `learning_rate` in a training :
- `learning_rate`
- `t5xxl_lr`
- `text_encoder_lr`
- `unet_lr`

All the values are the same, and the formula is the following :
$$
lr_{new} = lr_{old} * (\frac{train\_batch\_size*GPU\_number}{2})
$$

For example, flux 1.0 have a $$lr_{old} = 0.00005$$ and you want to train with 2 GPUs and 4 batch size, you will have a $$lr_{new} = 0.00005 * (\frac{4*2}{2}) = 0.0001$$ for all the 4 lr values.

This is a official config file for flux 1.0 krea :

### TOML file.
<CodeGroup>
    ```toml 2xH100_1bs.toml expandable lines
    ae = "/app/models/vae/ae.safetensors"
    apply_t5_attn_mask = true
    bucket_no_upscale = true
    bucket_reso_steps = 64
    cache_latents = true
    cache_latents_to_disk = true
    caption_extension = ".txt"
    clip_l = "/app/models/clip/clip_l.safetensors"
    discrete_flow_shift = 3.1582
    dynamo_backend = "no"
    epoch = 100
    full_bf16 = true
    gradient_accumulation_steps = 1
    gradient_checkpointing = true
    guidance_scale = 1.0
    highvram = true
    huber_c = 0.1
    huber_scale = 1
    huber_schedule = "snr"
    learning_rate = 5e-5
    logging_dir = "/app/output/log"
    loss_type = "l2"
    lr_scheduler = "constant"
    lr_scheduler_args = []
    lr_scheduler_num_cycles = 1
    lr_scheduler_power = 1
    max_bucket_reso = 2048
    max_data_loader_n_workers = 0
    max_timestep = 1000
    max_train_steps = 1000
    mem_eff_save = true
    min_bucket_reso = 256
    mixed_precision = "bf16"
    model_prediction_type = "raw"
    network_alpha = 128
    network_args = [ "train_double_block_indices=all", "train_single_block_indices=all", "train_t5xxl=True",]
    network_dim = 128
    network_module = "networks.lora_flux"
    noise_offset_type = "Original"
    optimizer_args = [ "scale_parameter=False", "relative_step=False", "warmup_init=False", "weight_decay=0.01",]
    optimizer_type = "Adafactor"
    output_dir = "/app/output/model"
    output_name = "rtx5090-fluxdev"
    pretrained_model_name_or_path = "/app/models/unet/flux1-krea-dev.safetensors"
    prior_loss_weight = 1
    resolution = "1024,1024"
    sample_prompts = "/app/output/model/sample/prompt.txt"
    sample_sampler = "euler_a"
    save_every_n_epochs = 25
    save_model_as = "safetensors"
    save_precision = "float"
    seed = 1
    t5xxl = "/app/models/clip/t5xxl_fp16.safetensors"
    t5xxl_max_token_length = 512
    text_encoder_lr = [ 5e-5, 5e-5,]
    timestep_sampling = "sigmoid"
    train_batch_size = 1
    train_data_dir = "/app/output/img"
    unet_lr = 5e-5
    vae_batch_size = 4
    wandb_run_name = "rtx5090-fluxdev"
    xformers = true
    ```
    ```toml 2xH100_7bs.toml expandable lines
    ae = "/app/models/vae/ae.safetensors"
    apply_t5_attn_mask = true
    bucket_no_upscale = true
    bucket_reso_steps = 64
    cache_latents = true
    cache_latents_to_disk = true
    caption_extension = ".txt"
    clip_l = "/app/models/clip/clip_l.safetensors"
    discrete_flow_shift = 3.1582
    dynamo_backend = "no"
    epoch = 100
    full_bf16 = true
    gradient_accumulation_steps = 1
    gradient_checkpointing = true
    guidance_scale = 1.0
    highvram = true
    huber_c = 0.1
    huber_scale = 1
    huber_schedule = "snr"
    learning_rate = 0.00035
    logging_dir = "/app/output/log"
    loss_type = "l2"
    lr_scheduler = "constant"
    lr_scheduler_args = []
    lr_scheduler_num_cycles = 1
    lr_scheduler_power = 1
    max_bucket_reso = 2048
    max_data_loader_n_workers = 0
    max_timestep = 1000
    max_train_steps = 143
    mem_eff_save = true
    min_bucket_reso = 256
    mixed_precision = "bf16"
    model_prediction_type = "raw"
    network_alpha = 128
    network_args = [ "train_double_block_indices=all", "train_single_block_indices=all", "train_t5xxl=True",]
    network_dim = 128
    network_module = "networks.lora_flux"
    noise_offset_type = "Original"
    optimizer_args = [ "scale_parameter=False", "relative_step=False", "warmup_init=False", "weight_decay=0.01",]
    optimizer_type = "Adafactor"
    output_dir = "/app/output/model"
    output_name = "rtx5090-fluxdev"
    pretrained_model_name_or_path = "/app/models/unet/flux1-krea-dev.safetensors"
    prior_loss_weight = 1
    resolution = "1024,1024"
    sample_prompts = "/app/output/model/sample/prompt.txt"
    sample_sampler = "euler_a"
    save_every_n_epochs = 25
    save_model_as = "safetensors"
    save_precision = "float"
    seed = 1
    t5xxl = "/app/models/clip/t5xxl_fp16.safetensors"
    t5xxl_max_token_length = 512
    text_encoder_lr = [ 0.00035, 0.00035,]
    timestep_sampling = "sigmoid"
    train_batch_size = 7
    train_data_dir = "/app/output/img"
    unet_lr = 0.00035
    vae_batch_size = 4
    wandb_run_name = "rtx5090-fluxdev"
    xformers = true
    ``` 
</CodeGroup>

### JSON file.
<CodeGroup>
    ```json 2xH100_1bs.json expandable lines
    {
      "LoRA_type": "Flux1",
      "LyCORIS_preset": "full",
      "adaptive_noise_scale": 0,
      "additional_parameters": "",
      "ae": "/app/models/vae/ae.safetensors",
      "apply_t5_attn_mask": true,
      "async_upload": false,
      "block_alphas": "",
      "block_dims": "",
      "block_lr_zero_threshold": "",
      "blocks_to_swap": 0,
      "bucket_no_upscale": true,
      "bucket_reso_steps": 64,
      "bypass_mode": false,
      "cache_latents": true,
      "cache_latents_to_disk": true,
      "caption_dropout_every_n_epochs": 0,
      "caption_dropout_rate": 0,
      "caption_extension": ".txt",
      "clip_g": "",
      "clip_g_dropout_rate": 0,
      "clip_l": "/app/models/clip/clip_l.safetensors",
      "clip_skip": 0,
      "color_aug": false,
      "constrain": 0,
      "conv_alpha": 1,
      "conv_block_alphas": "",
      "conv_block_dims": "",
      "conv_dim": 1,
      "cpu_offload_checkpointing": false,
      "dataset_config": "",
      "debiased_estimation_loss": false,
      "decompose_both": false,
      "dim_from_weights": false,
      "discrete_flow_shift": 3.1582,
      "dora_wd": false,
      "double_blocks_to_swap": 0,
      "down_lr_weight": "",
      "dynamo_backend": "no",
      "dynamo_mode": "default",
      "dynamo_use_dynamic": false,
      "dynamo_use_fullgraph": false,
      "enable_all_linear": false,
      "enable_bucket": false,
      "epoch": 100,
      "extra_accelerate_launch_args": "",
      "factor": -1,
      "flip_aug": false,
      "flux1_cache_text_encoder_outputs": false,
      "flux1_cache_text_encoder_outputs_to_disk": false,
      "flux1_checkbox": true,
      "fp8_base": false,
      "fp8_base_unet": false,
      "full_bf16": true,
      "full_fp16": false,
      "ggpo_beta": 0.01,
      "ggpo_sigma": 0.03,
      "gpu_ids": "0,1",
      "gradient_accumulation_steps": 1,
      "gradient_checkpointing": true,
      "guidance_scale": 1,
      "highvram": true,
      "huber_c": 0.1,
      "huber_scale": 1,
      "huber_schedule": "snr",
      "huggingface_path_in_repo": "",
      "huggingface_repo_id": "",
      "huggingface_repo_type": "",
      "huggingface_repo_visibility": "",
      "huggingface_token": "",
      "img_attn_dim": "",
      "img_mlp_dim": "",
      "img_mod_dim": "",
      "in_dims": "",
      "ip_noise_gamma": 0,
      "ip_noise_gamma_random_strength": false,
      "keep_tokens": 0,
      "learning_rate": 5e-05,
      "log_config": false,
      "log_tracker_config": "",
      "log_tracker_name": "",
      "log_with": "",
      "logging_dir": "/app/output/log",
      "logit_mean": 0,
      "logit_std": 1,
      "loraplus_lr_ratio": 0,
      "loraplus_text_encoder_lr_ratio": 0,
      "loraplus_unet_lr_ratio": 0,
      "loss_type": "l2",
      "lowvram": false,
      "lr_scheduler": "constant",
      "lr_scheduler_args": "",
      "lr_scheduler_num_cycles": 1,
      "lr_scheduler_power": 1,
      "lr_scheduler_type": "",
      "lr_warmup": 0,
      "lr_warmup_steps": 0,
      "main_process_port": 0,
      "masked_loss": false,
      "max_bucket_reso": 2048,
      "max_data_loader_n_workers": 0,
      "max_grad_norm": 0,
      "max_resolution": "1024,1024",
      "max_timestep": 1000,
      "max_token_length": 75,
      "max_train_epochs": 0,
      "max_train_steps": 0,
      "mem_eff_attn": false,
      "mem_eff_save": true,
      "metadata_author": "",
      "metadata_description": "",
      "metadata_license": "",
      "metadata_tags": "",
      "metadata_title": "",
      "mid_lr_weight": "",
      "min_bucket_reso": 256,
      "min_snr_gamma": 0,
      "min_timestep": 0,
      "mixed_precision": "bf16",
      "mode_scale": 1.29,
      "model_list": "custom",
      "model_prediction_type": "raw",
      "module_dropout": 0,
      "multi_gpu": true,
      "multires_noise_discount": 0.3,
      "multires_noise_iterations": 0,
      "network_alpha": 128,
      "network_dim": 128,
      "network_dropout": 0,
      "network_weights": "",
      "noise_offset": 0,
      "noise_offset_random_strength": false,
      "noise_offset_type": "Original",
      "num_cpu_threads_per_process": 2,
      "num_machines": 1,
      "num_processes": 2,
      "optimizer": "Adafactor",
      "optimizer_args": "scale_parameter=False relative_step=False warmup_init=False weight_decay=0.01",
      "output_dir": "/app/output/model",
      "output_name": "rtx5090-fluxdev",
      "persistent_data_loader_workers": false,
      "pos_emb_random_crop_rate": 0,
      "pretrained_model_name_or_path": "/app/models/unet/flux1-krea-dev.safetensors",
      "prior_loss_weight": 1,
      "random_crop": false,
      "rank_dropout": 0,
      "rank_dropout_scale": false,
      "reg_data_dir": "",
      "rescaled": false,
      "resume": "",
      "resume_from_huggingface": "",
      "sample_every_n_epochs": 0,
      "sample_every_n_steps": 0,
      "sample_prompts": "",
      "sample_sampler": "euler_a",
      "save_clip": false,
      "save_every_n_epochs": 25,
      "save_every_n_steps": 0,
      "save_last_n_epochs": 0,
      "save_last_n_epochs_state": 0,
      "save_last_n_steps": 0,
      "save_last_n_steps_state": 0,
      "save_model_as": "safetensors",
      "save_precision": "float",
      "save_state": false,
      "save_state_on_train_end": false,
      "save_state_to_huggingface": false,
      "save_t5xxl": false,
      "scale_v_pred_loss_like_noise_pred": false,
      "scale_weight_norms": 0,
      "sd3_cache_text_encoder_outputs": false,
      "sd3_cache_text_encoder_outputs_to_disk": false,
      "sd3_checkbox": false,
      "sd3_clip_l": "",
      "sd3_clip_l_dropout_rate": 0,
      "sd3_disable_mmap_load_safetensors": false,
      "sd3_enable_scaled_pos_embed": false,
      "sd3_fused_backward_pass": false,
      "sd3_t5_dropout_rate": 0,
      "sd3_t5xxl": "",
      "sd3_text_encoder_batch_size": 1,
      "sdxl": false,
      "sdxl_cache_text_encoder_outputs": false,
      "sdxl_no_half_vae": false,
      "seed": 1,
      "shuffle_caption": false,
      "single_blocks_to_swap": 0,
      "single_dim": "",
      "single_mod_dim": "",
      "skip_cache_check": false,
      "split_mode": false,
      "split_qkv": false,
      "stop_text_encoder_training": 0,
      "t5xxl": "/app/models/clip/t5xxl_fp16.safetensors",
      "t5xxl_device": "",
      "t5xxl_dtype": "bf16",
      "t5xxl_lr": 5e-05,
      "t5xxl_max_token_length": 512,
      "text_encoder_lr": 5e-05,
      "timestep_sampling": "sigmoid",
      "train_batch_size": 1,
      "train_blocks": "all",
      "train_data_dir": "/app/output/img",
      "train_double_block_indices": "all",
      "train_lora_ggpo": false,
      "train_norm": false,
      "train_on_input": true,
      "train_single_block_indices": "all",
      "train_t5xxl": true,
      "training_comment": "",
      "txt_attn_dim": "",
      "txt_mlp_dim": "",
      "txt_mod_dim": "",
      "unet_lr": 5e-05,
      "unit": 1,
      "up_lr_weight": "",
      "use_cp": false,
      "use_scalar": false,
      "use_tucker": false,
      "v2": false,
      "v_parameterization": false,
      "v_pred_like_loss": 0,
      "vae": "",
      "vae_batch_size": 4,
      "wandb_api_key": "",
      "wandb_run_name": "",
      "weighted_captions": false,
      "weighting_scheme": "logit_normal",
      "xformers": "xformers"
    }
    ```
    ```json 2xH100_7bs.json expandable lines
    {
      "LoRA_type": "Flux1",
      "LyCORIS_preset": "full",
      "adaptive_noise_scale": 0,
      "additional_parameters": "",
      "ae": "/app/models/vae/ae.safetensors",
      "apply_t5_attn_mask": true,
      "async_upload": false,
      "block_alphas": "",
      "block_dims": "",
      "block_lr_zero_threshold": "",
      "blocks_to_swap": 0,
      "bucket_no_upscale": true,
      "bucket_reso_steps": 64,
      "bypass_mode": false,
      "cache_latents": true,
      "cache_latents_to_disk": true,
      "caption_dropout_every_n_epochs": 0,
      "caption_dropout_rate": 0,
      "caption_extension": ".txt",
      "clip_g": "",
      "clip_g_dropout_rate": 0,
      "clip_l": "/app/models/clip/clip_l.safetensors",
      "clip_skip": 0,
      "color_aug": false,
      "constrain": 0,
      "conv_alpha": 1,
      "conv_block_alphas": "",
      "conv_block_dims": "",
      "conv_dim": 1,
      "cpu_offload_checkpointing": false,
      "dataset_config": "",
      "debiased_estimation_loss": false,
      "decompose_both": false,
      "dim_from_weights": false,
      "discrete_flow_shift": 3.1582,
      "dora_wd": false,
      "double_blocks_to_swap": 0,
      "down_lr_weight": "",
      "dynamo_backend": "no",
      "dynamo_mode": "default",
      "dynamo_use_dynamic": false,
      "dynamo_use_fullgraph": false,
      "enable_all_linear": false,
      "enable_bucket": false,
      "epoch": 100,
      "extra_accelerate_launch_args": "",
      "factor": -1,
      "flip_aug": false,
      "flux1_cache_text_encoder_outputs": false,
      "flux1_cache_text_encoder_outputs_to_disk": false,
      "flux1_checkbox": true,
      "fp8_base": false,
      "fp8_base_unet": false,
      "full_bf16": true,
      "full_fp16": false,
      "ggpo_beta": 0.01,
      "ggpo_sigma": 0.03,
      "gpu_ids": "0,1",
      "gradient_accumulation_steps": 1,
      "gradient_checkpointing": true,
      "guidance_scale": 1,
      "highvram": true,
      "huber_c": 0.1,
      "huber_scale": 1,
      "huber_schedule": "snr",
      "huggingface_path_in_repo": "",
      "huggingface_repo_id": "",
      "huggingface_repo_type": "",
      "huggingface_repo_visibility": "",
      "huggingface_token": "",
      "img_attn_dim": "",
      "img_mlp_dim": "",
      "img_mod_dim": "",
      "in_dims": "",
      "ip_noise_gamma": 0,
      "ip_noise_gamma_random_strength": false,
      "keep_tokens": 0,
      "learning_rate": 0.00035,
      "log_config": false,
      "log_tracker_config": "",
      "log_tracker_name": "",
      "log_with": "",
      "logging_dir": "/app/output/log",
      "logit_mean": 0,
      "logit_std": 1,
      "loraplus_lr_ratio": 0,
      "loraplus_text_encoder_lr_ratio": 0,
      "loraplus_unet_lr_ratio": 0,
      "loss_type": "l2",
      "lowvram": false,
      "lr_scheduler": "constant",
      "lr_scheduler_args": "",
      "lr_scheduler_num_cycles": 1,
      "lr_scheduler_power": 1,
      "lr_scheduler_type": "",
      "lr_warmup": 0,
      "lr_warmup_steps": 0,
      "main_process_port": 0,
      "masked_loss": false,
      "max_bucket_reso": 2048,
      "max_data_loader_n_workers": 0,
      "max_grad_norm": 0,
      "max_resolution": "1024,1024",
      "max_timestep": 1000,
      "max_token_length": 75,
      "max_train_epochs": 0,
      "max_train_steps": 0,
      "mem_eff_attn": false,
      "mem_eff_save": true,
      "metadata_author": "",
      "metadata_description": "",
      "metadata_license": "",
      "metadata_tags": "",
      "metadata_title": "",
      "mid_lr_weight": "",
      "min_bucket_reso": 256,
      "min_snr_gamma": 0,
      "min_timestep": 0,
      "mixed_precision": "bf16",
      "mode_scale": 1.29,
      "model_list": "custom",
      "model_prediction_type": "raw",
      "module_dropout": 0,
      "multi_gpu": true,
      "multires_noise_discount": 0.3,
      "multires_noise_iterations": 0,
      "network_alpha": 128,
      "network_dim": 128,
      "network_dropout": 0,
      "network_weights": "",
      "noise_offset": 0,
      "noise_offset_random_strength": false,
      "noise_offset_type": "Original",
      "num_cpu_threads_per_process": 2,
      "num_machines": 1,
      "num_processes": 2,
      "optimizer": "Adafactor",
      "optimizer_args": "scale_parameter=False relative_step=False warmup_init=False weight_decay=0.01",
      "output_dir": "/app/output/model",
      "output_name": "rtx5090-fluxdev",
      "persistent_data_loader_workers": false,
      "pos_emb_random_crop_rate": 0,
      "pretrained_model_name_or_path": "/app/models/unet/flux1-krea-dev.safetensors",
      "prior_loss_weight": 1,
      "random_crop": false,
      "rank_dropout": 0,
      "rank_dropout_scale": false,
      "reg_data_dir": "",
      "rescaled": false,
      "resume": "",
      "resume_from_huggingface": "",
      "sample_every_n_epochs": 0,
      "sample_every_n_steps": 0,
      "sample_prompts": "",
      "sample_sampler": "euler_a",
      "save_clip": false,
      "save_every_n_epochs": 25,
      "save_every_n_steps": 0,
      "save_last_n_epochs": 0,
      "save_last_n_epochs_state": 0,
      "save_last_n_steps": 0,
      "save_last_n_steps_state": 0,
      "save_model_as": "safetensors",
      "save_precision": "float",
      "save_state": false,
      "save_state_on_train_end": false,
      "save_state_to_huggingface": false,
      "save_t5xxl": false,
      "scale_v_pred_loss_like_noise_pred": false,
      "scale_weight_norms": 0,
      "sd3_cache_text_encoder_outputs": false,
      "sd3_cache_text_encoder_outputs_to_disk": false,
      "sd3_checkbox": false,
      "sd3_clip_l": "",
      "sd3_clip_l_dropout_rate": 0,
      "sd3_disable_mmap_load_safetensors": false,
      "sd3_enable_scaled_pos_embed": false,
      "sd3_fused_backward_pass": false,
      "sd3_t5_dropout_rate": 0,
      "sd3_t5xxl": "",
      "sd3_text_encoder_batch_size": 1,
      "sdxl": false,
      "sdxl_cache_text_encoder_outputs": false,
      "sdxl_no_half_vae": false,
      "seed": 1,
      "shuffle_caption": false,
      "single_blocks_to_swap": 0,
      "single_dim": "",
      "single_mod_dim": "",
      "skip_cache_check": false,
      "split_mode": false,
      "split_qkv": false,
      "stop_text_encoder_training": 0,
      "t5xxl": "/app/models/clip/t5xxl_fp16.safetensors",
      "t5xxl_device": "",
      "t5xxl_dtype": "bf16",
      "t5xxl_lr": 0.00035,
      "t5xxl_max_token_length": 512,
      "text_encoder_lr": 0.00035,
      "timestep_sampling": "sigmoid",
      "train_batch_size": 7,
      "train_blocks": "all",
      "train_data_dir": "/app/output/img",
      "train_double_block_indices": "all",
      "train_lora_ggpo": false,
      "train_norm": false,
      "train_on_input": true,
      "train_single_block_indices": "all",
      "train_t5xxl": true,
      "training_comment": "",
      "txt_attn_dim": "",
      "txt_mlp_dim": "",
      "txt_mod_dim": "",
      "unet_lr": 0.00035,
      "unit": 1,
      "up_lr_weight": "",
      "use_cp": false,
      "use_scalar": false,
      "use_tucker": false,
      "v2": false,
      "v_parameterization": false,
      "v_pred_like_loss": 0,
      "vae": "",
      "vae_batch_size": 4,
      "wandb_api_key": "",
      "wandb_run_name": "",
      "weighted_captions": false,
      "weighting_scheme": "logit_normal",
      "xformers": "xformers"
    }
    ```
</CodeGroup>





<Tabs>
  <Tab title="Flux 1.0 Dev">

  </Tab>

  <Tab title="Flux 1.0 Krea">

  ### Speed and price.


  <Frame caption="Speed and Price.">
    <img src="/images/FluxKreaCharts.png" alt="Flux 1.0 Krea"/>
  </Frame>

  ### VRAM.
  
  <Columns cols={2}>
    <Frame caption="VRAM 2xH100-7BS">
      <img src="/images/2xh100_7bs_vram.png" alt="Flux 1.0 Krea"/>
    </Frame>
    <Frame caption="VRAM 2xH100-1BS">
      <img src="/images/2xh100_1bs_vram.png" alt="Flux 1.0 Krea"/>
    </Frame>
  </Columns>
  
  </Tab>
</Tabs>